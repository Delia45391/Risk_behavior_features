8. Suppose there’s another table with the individuals name and their job, and has the same number of rows as the risk_behavior_features. Select top 10 highest income and analyse the best paid jobs.

I have created a new table called Persons, as it follows:

CREATE TABLE Persons (
Person_Id INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
Person_name VARCHAR(250) NOT NULL,
City VARCHAR(200) NOT NULL,
Job VARCHAR(200) NOT NULL
);

INSERT INTO Persons(Person_name, City, Job) 
VALUES
('Ozzy Osbourne', 'Birmingham', 'Singer'),
('David Bowie', 'Bucharest', 'Data Analyst'),
('Mick Jagger', 'Paris', 'Waiter'),
('Elton John', 'Tokyo', 'Software Developer'),
('Freddie Mercury', 'Frankfurt', 'Economist'),
('Robert Plant', 'Copenhagen', 'Tourist Guide'),
('Paul McCartney', 'Seul', 'Chef'),
('Sting', 'Cairo', 'Waiter'),
('Bono', 'London', 'Designer'),
('Adele Adkins', 'Bucharest', 'Plumber'),
('John Lennon', 'Paris', 'Singer'),
('Kurt Cobain', 'Tokyo', 'Data Analyst'),
('Dave Grohl', 'Frankfurt', 'Waiter'),
('Liam Gallagher', 'Copenhagen', 'Software Developer'),
('Noel Gallagher', 'Seul', 'Economist'),
('Chris Martin', 'Cairo', 'Tourist Guide'),
('Thom Yorke', 'London', 'Chef'),
('Bjork', 'Bucharest', 'Waiter'),
('Shakira', 'Paris', 'Designer'),
('Rihanna', 'Tokyo', 'Plumber'),
('David Beckham', 'Frankfurt', 'Singer'),
('Cristiano Ronaldo', 'Copenhagen', 'Data Analyst'),
('Lionel Messi', 'Seul', 'Waiter'),
('Neymar Jr.', 'Cairo', 'Software Developer'),
('Harry Kane', 'London', 'Economist'),
('Marcus Rashford', 'Bucharest', 'Tourist Guide'),
('Wayne Rooney', 'Paris', 'Chef'),
('Paulo Dybala', 'Tokyo', 'Waiter'),
('Karim Benzema', 'Frankfurt', 'Designer'),
('Zlatan Ibrahimovic', 'Copenhagen', 'Plumber'),
('Elon Musk', 'Seul', 'Singer'),
('Mark Zuckerberg', 'Cairo', 'Data Analyst'),
('Bill Gates', 'London', 'Waiter'),
('Larry Page', 'Bucharest', 'Software Developer'),
('Sergey Brin', 'Paris', 'Economist'),
('Jeff Bezos', 'Tokyo', 'Tourist Guide'),
('Steve Jobs', 'Frankfurt', 'Chef'),
('Satya Nadella', 'Copenhagen', 'Waiter'),
('Sundar Pichai', 'Seul', 'Designer'),
('Tim Cook', 'Cairo', 'Plumber'),
('Warren Buffett', 'London', 'Singer'),
('Christine Lagarde', 'Bucharest', 'Data Analyst'),
('Mario Draghi', 'Paris', 'Waiter'),
('Paul Krugman', 'Tokyo', 'Software Developer'),
('Janet Yellen', 'Frankfurt', 'Economist'),
('Joseph Stiglitz', 'Copenhagen', 'Tourist Guide'),
('Milton Friedman', 'Seul', 'Chef'),
('Adam Smith', 'Cairo', 'Waiter'),
('David Ricardo', 'London', 'Designer'),
('Karl Marx', 'Bucharest', 'Plumber'),
('Gordon Ramsay', 'Paris', 'Singer'),
('Jamie Oliver', 'Tokyo', 'Data Analyst'),
('Anthony Bourdain', 'Frankfurt', 'Waiter'),
('Nigella Lawson', 'Copenhagen', 'Software Developer'),
('Heston Blumenthal', 'Seul', 'Economist'),
('Wolfgang Puck', 'Cairo', 'Tourist Guide'),
('Alain Ducasse', 'London', 'Chef'),
('Massimo Bottura', 'Bucharest', 'Waiter'),
('Rene Redzepi', 'Paris', 'Designer'),
('Paul Bocuse', 'Tokyo', 'Plumber'),
('David Chang', 'Frankfurt', 'Singer'),
('Marco Pierre White', 'Copenhagen', 'Data Analyst'),
('Ferran Adrià', 'Seul', 'Waiter'),
('Remy Martin', 'Cairo', 'Software Developer'),
('Virgil Abloh', 'London', 'Economist'),
('Karl Lagerfeld', 'Bucharest', 'Tourist Guide'),
('Coco Chanel', 'Paris', 'Chef'),
('Giorgio Armani', 'Tokyo', 'Waiter'),
('Donatella Versace', 'Frankfurt', 'Designer'),
('Ralph Lauren', 'Copenhagen', 'Plumber'),
('Tom Ford', 'Seul', 'Singer'),
('Stella McCartney', 'Cairo', 'Data Analyst'),
('Yves Saint Laurent', 'London', 'Waiter');

SELECT * FROM Persons;

It has some celebrities name, cities and their job (fictive data – this is just for analysis thinking purpose).
Then, I need to join the Persons_name and Job columns from Persons table with the Income column from Risk_behavior_features table using the common column from the tables and because the both tables have the same number of rows, I am using an INNER JOIN:

SELECT
	r.ID,
  r.Income,
  p.Person_name,
  p.Job
FROM risk_behavior_features r
INNER JOIN Persons p ON r.ID = p.Person_Id
ORDER BY Income DESC
LIMIT 10;

The top 10 highest-paid occupations are dominated by Software Developer and Waiter, each appearing three times. This distribution shows that there are concentrations of high incomes in certain professions in the data set. However, there are also diverse occupations in this top 10 (Designer, Data Analyst, Economist, Plumber), suggesting that high salaries are not limited to a single field, but occur across multiple professions.

The subquery below helps in finding the number of job appearance in the top 10 highest income.

SELECT
	Job,
	COUNT(*) as Appearance
FROM (
	SELECT
		p.Job
	FROM risk_behavior_features r 
	INNER JOIN Persons p ON r.ID=p.Person_Id
	ORDER BY r.Income DESC
	LIMIT 10) as Top10
GROUP BY Job;
